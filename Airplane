/**
 * Write a description of class Airplane here.
 * 
 * @author (your name) 
 * @version (a version number or a date)
 */
import java.util.Random;
import java.util.Scanner;

public class Airplane
{
   private final int ROW = 13;  //ROW 1 - 12
   private final int SECTION = 5; //SEAT A - D
   private Seat[][] seats;
   private Random generator = new Random();
   private final int numberOfSeats = 48;
   private int grouping;
   private int startRow;
   private int startColumn;
   private int rowPartner;
   private int columnPartner; 
   private int seatsLeft;
   private int numberOfRandom;
   private int choise;
   
   public Airplane()
   {
       seatsLeft = 48;
       numberOfRandom = 48;
       seats = new Seat[SECTION][ROW];
       initializeSeats();
       randomFill();
   }
    
   public void initializeSeats()
   {
       for (int j = 1; j < ROW; j++)
       {
           boolean firstClass = true;
           if (j > 4)
                firstClass = false;
                
           for (int i = 1; i < SECTION; i++)
           {
               String section = "E";
               boolean windowView = true;
               
               if (i == 1)
                   section = "A";
               else if (i == 2)
               {
                   section = "B";
                   windowView =false;
                }
               else if (i == 3)
               {
                   section = "C";
                   windowView = false;
                }
                else
                    section = "D";
              
               Seat temp = new Seat(section,j);
               temp.setWindowView(windowView);
               //temp.setSeatSection(section);
               temp.setSeatClass(firstClass);
               seats[i][j] = temp;
            }
        }
    }

   public void windowSingle(Passenger p, int classNumber)
   {
       int section = SECTION;
       if (classNumber == 1)
       {
           section = 5;
       }
       for (int j = 1; j < 2; j++)
       {  
           for (int i = classNumber; i < section; i++)
           {
               if (seats[j][i].getVacancy() == true)
               {
                   seats[j][i].assignPassenger(p);
                   seats[j][i].setVacancy(false);
                   break;
               }
               
               else if (seats[4][i].getVacancy() == true)
               {
                   seats[4][i].assignPassenger(p);
                   seats[4][i].setVacancy(false);
                   break;
               }
               else
               {
                   System.out.print("There are no more seats.");
               }
           }
       }
   }
    
   public void notWindowSingle(Passenger p,int classNumber)
   {
       int section = SECTION;
       if (classNumber == 1)
       {
           section = 5;
       }
       for (int j = 2; j < 3; j++)
       {  
           for (int i = classNumber; i < section; i++)
           {
               if (seats[j][i].getVacancy() == true)
               {
                   seats[j][i].assignPassenger(p);
                   seats[j][i].setVacancy(false);
                   break;
               }
               else if (seats[3][i].getVacancy() == true)
               {
                   seats[3][i].assignPassenger(p);
                   seats[3][i].setVacancy(false);
                   break;
               }
           }
       }
   }
   
   public void randomFill()
   {
       Random generator = new Random();
       int counter = 1;
       while (counter <= numberOfRandom)
        {
           int section = generator.nextInt(4) + 1;
           int row = generator.nextInt(12) + 1;
            
           if (seats[section][row].getVacancy() == true)
           {
               seats[section][row].setVacancy(false);
               Passenger jay = new Passenger("Jay" + counter, "Chou");
               seats[section][row].assignPassenger(jay);
               seatsLeft--;
               counter++;
           }
       }
   }
   
   public void randomSeating(Passenger p, int grouping)
   {
           Random generator = new Random();
           int section = generator.nextInt(ROW-1) + 1;
           int row = generator.nextInt(SECTION-1) + 1;   
           if (seats[row][section].getVacancy() == true)
           {
               seats[row][section].setVacancy(false);
               seats[row][section].assignPassenger(p);
               seatsLeft--;
           }
   }
   
   public void reserveSeats(Passenger p, String row, int seatNumber)
   {
       if (row.equalsIgnoreCase("a") && (seats[1][seatNumber].getVacancy() == true))
       {
           seats[1][seatNumber].assignPassenger(p);
           seats[1][seatNumber].setVacancy(false);
           seatsLeft--;
       }
       else if (row.equalsIgnoreCase("b") && (seats[2][seatNumber].getVacancy() == true))
       {
           seats[2][seatNumber].assignPassenger(p);
           seats[2][seatNumber].setVacancy(false);
           seatsLeft--;
       }
       else if (row.equalsIgnoreCase("c") && (seats[3][seatNumber].getVacancy() == true))
       {
           seats[3][seatNumber].assignPassenger(p);
           seats[3][seatNumber].setVacancy(false);
           seatsLeft--;;
       }
       else if (row.equalsIgnoreCase("d") && (seats[4][seatNumber].getVacancy() == true))
       {
           seats[4][seatNumber].assignPassenger(p);
           seats[4][seatNumber].setVacancy(false);
           seatsLeft--;;
       }
       else
       {
           System.out.println("Cannot be done.");
       }
   }
   
   public void printSeats() //*
   {
       for (int j = 1; j < SECTION; j++)
       {
           for (int i = 1; i < ROW; i++)
           {
               if (seats[j][i].getVacancy()==false)
                   System.out.print("["+"X"+"]  ");
               else
               System.out.print("[ " + "]  ");
           }
           System.out.println();
       }
   }
   
   public boolean rowPreferences(int grouping) //*
   {
       int count = 0;       
       if (grouping > 1)
       {
           for (int i = 0; i < SECTION; i++)
           {
               for (int j = 0; j < ROW; j++)
               {
                   if (seats[i][j].getVacancy() == true)
                   {
                       count++;
                       startRow = j;
                       rowPartner = i;
                   }
                   else
                   {
                       count = 0;
                       startRow = -1;
                       rowPartner = -1;
                   }
               }
           }
       }
       
       else
       {
           return true;
       }
       if (count == grouping)
       {
           startRow = startRow-grouping;
           return true;
       }
       else
       {
           return false;
       }
   }
   
   public boolean columnPreferences (int grouping) //*
   {
       int count = 0;       
       if (grouping <=4)
       {
           for (int i = 0; i < ROW; i++)
           {
               for (int j = 0; j < SECTION; j++)
               {
                   if (seats[i][j].getVacancy() == true)
                   {
                       count++;
                       startColumn = j-grouping;
                   }
                   else
                   {
                       count = 0;
                   }
               }
           }
       }
       
       if (count == grouping)
       {
           startColumn = startColumn-grouping;
           return true;
       }
       else
       {
           return false;
       }
   }
   
   public void assignment(Passenger p, int grouping)
   {
       if (rowPreferences(grouping) == true)
       {
           for (int i = startRow; i < startRow+grouping; i++)
           {
               seats[rowPartner][i].assignPassenger(p);
               seats[rowPartner][i].setVacancy(false);
               seatsLeft = seatsLeft - grouping;
           }
       }
       else if (columnPreferences(grouping) == true)
       {
           for (int i = startColumn; i < startColumn + grouping; i++)
           {
               seats[columnPartner][i].assignPassenger(p);
               seats[columnPartner][i].setVacancy(false);
               seatsLeft = seatsLeft - grouping;
           }
       }
       else
       {
           System.out.print("It is not possible");
       }
   }
   
   public void printName()
     {
         String[] columnLetters = {"","A","B","C","D"};
          for(int k = 1; k < SECTION; k++)
          {
              for(int i = 1; i < ROW; i++)
              {
                if(seats[k][i].getVacancy()== false)
                  {
                 System.out.println("Column: "+columnLetters[k]+ " Row: " + i + " Passengers: " + seats[k][i].getPassenger().getFullName());
                  }
              }
          }
      }
   
      public void removePassenger(int row, String column) 
      {
	   
	   int columnNum = 0;
	   
	   if(column.equals("A")) {
			columnNum = 1;
		} else if(column.equals("B")) {
			columnNum = 2;
		} else if(column.equals("C")) {
			columnNum = 3;
		} else {
			columnNum = 4;
		}
	   
	   if(seats[columnNum][row].getVacancy() == false) {
		   seats[columnNum][row].setVacancy(true);
	   }
	   
   }
   
   public void displayMenu() //*
   {
       
   Scanner input = new Scanner(System.in);
   boolean cont = true;
   
   while(cont == true)
   {
           System.out.println();
           System.out.println("Enter 0 to display all seats");
           System.out.println("Enter 1 to reserve seats manually");
           System.out.println("Enter 2 to reserve any available seats (no preferences) for one person");
           System.out.println("Enter 3 to reserve seats with preferential seating");
           System.out.println("Enter 4 to cancel/update a reservation");
           System.out.println("Enter 5 to print all passengers names");
           System.out.println("Enter any other number to exit");
           int a = input.nextInt();

           if(a == 0) 
           {
               printSeats();            
           }
           
           else if (a == 1)
           {
               System.out.print("Enter in your first name: ");
               String firname = input.next();
               System.out.print("Enter in your last name: ");
               String laname = input.next();
               Passenger donny = new Passenger(firname, laname);
               System.out.println("Enter in row letter and seat number: ");
               String bow = input.next();
               reserveSeats(donny, bow.substring(0,1), Integer.parseInt(bow.substring(1)));
           }
           
           else if (a == 2) 
           {
               System.out.print("Enter in your first name: ");
               String firname = input.next();
               System.out.print("Enter in your last name: ");
               String laname = input.next();
               Passenger donny = new Passenger(firname, laname);
               randomSeating(donny, 1);
           }
           
           else if (a == 3) 
           {
               System.out.println("Would you like to be seated in a group or as a single?");
               System.out.println("Enter 1 for single, 2 for group");
               int choice = input.nextInt();
               if (choice == 1)
               {
                   System.out.print("Enter in your first name: ");
                   String firname = input.next();
                   System.out.print("Enter in your last name: ");
                   String laname = input.next();
                   Passenger donny = new Passenger(firname, laname);
                   System.out.print("Would you like a first class seat? (y/n)");
                   if (input.next().equals("y"))
                   {
                       choise = 1;
                       System.out.print("Would you like to reserve a window seat? (y/n)");
                       if (input.next().equalsIgnoreCase("y"))
                       {
                       windowSingle(donny, choise);
                       }
                       else
                       {
                       notWindowSingle(donny, choise);
                       }
                   }
                   else
                   {
                       choise = 5;
                       System.out.print("Would you like to reserve a window seat? (y/n)");
                       if (input.next().equalsIgnoreCase("y"))
                       {
                       windowSingle(donny, choise);
                       }
                       else
                       {
                       notWindowSingle(donny, choise);
                       }
                   }
               }
               
               else if (choice == 2)
               {
                   System.out.println("How many people would you like to be grouped with?");
                   int grouping = input.nextInt();
                   if (rowPreferences(grouping) == true)
                   {
                       for (int i = 0; i < grouping; i++)
                       {
                           System.out.print("Enter in passenger's first name: ");
                           String firstname = input.next();
                           System.out.print("Enter in passenger's last name: ");
                           String lastname = input.next();
                           Passenger donster = new Passenger(firstname, lastname);
                           assignment(donster, grouping);
                       }
                   }
               }
               
               else
               {
                   System.out.print("That is not a valid option");
               }
           }
               
           else if (a == 4) 
           {
               System.out.print("What row is the person sitting in? (A,B,C,D):");
               String inserted = input.next();
               System.out.print("What is the column the person is sitting in? (1-12):");
               int bobby = input.nextInt();
               removePassenger(bobby, inserted);
               System.out.print("Would you like to update the reservation? (y/n)");
               if (input.next().equals("y"))
               {
               System.out.println("Enter in row letter and seat number: ");
               String bow = input.next();
               System.out.println("Enter in first name of passenger");
               String fN = input.next();
               System.out.println("Enter in last name of passenger");
               String lN = input.next();
               Passenger breh = new Passenger(fN, lN);
               reserveSeats(breh, bow.substring(0,1), Integer.parseInt(bow.substring(1)));
               }
               else
               {
                   
               }
           }
           
           else if(a == 5) //*
           {
               printName();
           }
           
           else 
           {
               cont = false;
           }
   }
   } 
}
